(this["webpackJsonpmartins-sprinklers-client"]=this["webpackJsonpmartins-sprinklers-client"]||[]).push([[0],[,,,,,,,,,,,,,function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){},,,function(n,e,t){},function(n,e,t){"use strict";t.r(e);var c,o=t(1),a=t.n(o),i=t(7),s=t.n(i),r=(t(13),t(3)),u=t(6),l=(t(14),"10.0.0.28"),d="http://".concat(l,":").concat(3217),f="ws://".concat(l,":").concat(1337),j=3e4,O=(t(15),t(16),t(0)),b=function(n){var e=n.initial,t=n.remaining,c=n.children,o=n.dir,a="down"===(void 0===o?"down":o)?{top:"".concat(100-t/e*100,"%")}:{top:"".concat(t/e*100,"%")};return Object(O.jsxs)("div",{className:"countdown",children:[Object(O.jsx)("div",{className:"countdown-phaser",style:a}),Object(O.jsx)("div",{className:"countdown-children",children:c})]})},h=t(5),p=t.n(h),v=t(8),m=function(){var n=Object(v.a)(p.a.mark((function n(e){return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("Would have called",e,"fetch(".concat(d,"/channel/").concat(e.id,"/").concat(e.state,").then(rsp => rsp.json());")),n.abrupt("return",fetch("".concat(d,"/channel/").concat(e.id,"/").concat(e.state)).then((function(n){return n.json()})));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),g=t(2);!function(n){n.ON="on",n.OFF="off"}(c||(c={}));for(var N,x,w=function(n){return Object(g.a)(Object(g.a)({},n),{},{state:c.ON})},C=function(n){return Object(g.a)(Object(g.a)({},n),{},{state:c.OFF})},E={id:0,state:c.OFF},k=function(n){var e=n.name,t=n.zoneInfos,c=t[0],o=t[1],i=a.a.useState(void 0),s=Object(r.a)(i,2),u=s[0],l=s[1],d=a.a.useState(void 0),f=Object(r.a)(d,2),h=f[0],p=f[1],v=function(n){u&&u>0||function(n,e,t){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,o=e;m(w(n)),setTimeout((function(){m(C(n))}),e),t(o);var a=setInterval((function(){o<=0?clearInterval(a):t(o-=c)}),c)}(n,j,g)},g=function(n){n&&n>0?l(n):(l(void 0),p(void 0))};return Object(O.jsxs)("div",{className:"coop-door",children:[Object(O.jsx)("div",{className:"coop-door_open btn",onClick:function(){p("opening"),v(c)},children:u&&"opening"===h?Object(O.jsx)(b,{initial:j,remaining:u,dir:"up",children:"Open"}):"Open"}),e," ",u?"".concat(u/1e3,"s"):null,Object(O.jsx)("div",{className:"coop-door_close btn",onClick:function(){p("closing"),v(o)},children:u&&"closing"===h?Object(O.jsx)(b,{initial:j,remaining:u,children:"Close"}):"Close"})]})},F=(t(19),function(n){var e=n.zoneInfo;return Object(O.jsxs)("div",{className:"zone btn ".concat(e.state),onClick:function(){return m(function(n){return Object(g.a)(Object(g.a)({},n),{},{state:(e=n.state,e===c.ON?c.OFF:c.ON)});var e}(e))},children:["Zone ",e.id]})}),S=[],I=function(n){S.push(Object(u.a)(E,(function(e){e.id=n})))},R=1;R<=8;R++)I(R);!function(n){n.CONNECTING="connecting",n.OPEN="open",n.CLOSED="closed",n.ERROR="error"}(N||(N={}));var z=function(){var n=a.a.useState(S),e=Object(r.a)(n,2),t=e[0],c=e[1],o=a.a.useState(N.CONNECTING),i=Object(r.a)(o,2),s=i[0],l=i[1];return a.a.useEffect((function(){s===N.ERROR||x||((x=new WebSocket(f)).onopen=function(){x.send(JSON.stringify({id:void 0,msg:"Client connected!"})),l(N.OPEN)},x.onmessage=function(n){var e;n||n.data||console.log("Error receving ws message or message data",n);try{e=JSON.parse(n.data)}catch(a){throw console.log("Error parsing message.data from websockets"),new Error(a)}var o=Object(u.a)(t,(function(n){n[e.id-1]=e}));c(o)},x.onclose=function(){return l(N.CLOSED)},x.onerror=function(){x.close(),l(N.ERROR)})}),[s,t]),Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)("header",{className:"App-header",children:Object(O.jsx)("h1",{className:"title",children:"Martins' Sprinklers"})}),Object(O.jsxs)("div",{className:"controls",children:[Object(O.jsx)(k,{name:"Chickens",zoneInfos:[t[6],t[5]]}),Object(O.jsx)(k,{name:"Ducks",zoneInfos:[t[7],t[8]]}),t.filter((function(n){return n.id<=4})).map((function(n){return Object(O.jsx)(F,{zoneInfo:n},n.id)}))]}),Object(O.jsxs)("div",{className:"ws-status",children:["ws: ",s]})]})},y=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,21)).then((function(e){var t=e.getCLS,c=e.getFID,o=e.getFCP,a=e.getLCP,i=e.getTTFB;t(n),c(n),o(n),a(n),i(n)}))};s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(z,{})}),document.getElementById("root")),y()}],[[20,1,2]]]);
//# sourceMappingURL=main.eea8bfad.chunk.js.map