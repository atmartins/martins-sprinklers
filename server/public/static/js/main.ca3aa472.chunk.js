(this["webpackJsonpmartins-sprinklers-client"]=this["webpackJsonpmartins-sprinklers-client"]||[]).push([[0],[,,,,,,,,,,,,,function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){},,,function(n,e,t){},function(n,e,t){"use strict";t.r(e);var c,o=t(1),i=t.n(o),r=t(7),a=t.n(r),s=(t(13),t(3)),u=t(6),d=(t(14),"10.0.0.28"),l="http://".concat(d,":").concat(3217),f="ws://".concat(d,":").concat(1337),j=2e4,O=(t(15),t(16),t(0)),b=function(n){var e=n.initial,t=n.remaining,c=n.children,o=n.dir,i="down"===(void 0===o?"down":o)?{top:"".concat(100-t/e*100,"%")}:{top:"".concat(t/e*100,"%")};return Object(O.jsxs)("div",{className:"countdown",children:[Object(O.jsx)("div",{className:"countdown-phaser",style:i}),Object(O.jsx)("div",{className:"countdown-children",children:c})]})},v=t(5),h=t.n(v),p=t(8),m=function(){var n=Object(p.a)(h.a.mark((function n(e){return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",fetch("".concat(l,"/channel/").concat(e.id,"/").concat(e.state)).then((function(n){return n.json()})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),g=t(2);!function(n){n.ON="on",n.OFF="off"}(c||(c={}));for(var N,x,w=function(n){return Object(g.a)(Object(g.a)({},n),{},{state:c.ON})},C=function(n){return Object(g.a)(Object(g.a)({},n),{},{state:c.OFF})},E={id:0,state:c.OFF},k=function(n){var e=n.name,t=n.zoneInfos,c=t[0],o=t[1],r=i.a.useState(void 0),a=Object(s.a)(r,2),u=a[0],d=a[1],l=i.a.useState(void 0),f=Object(s.a)(l,2),v=f[0],h=f[1],p=function(n){u&&u>0||function(n,e,t){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,o=e;m(w(n)),setTimeout((function(){m(C(n))}),e),t(o);var i=setInterval((function(){o<=0?clearInterval(i):t(o-=c)}),c)}(n,j,g)},g=function(n){n&&n>0?d(n):(d(void 0),h(void 0))};return Object(O.jsxs)("div",{className:"coop-door",children:[Object(O.jsx)("div",{className:"coop-door_open btn",onClick:function(){h("opening"),p(c)},children:u&&"opening"===v?Object(O.jsx)(b,{initial:j,remaining:u,dir:"up",children:Object(O.jsxs)("div",{children:["Open ",c.id]})}):"Open ".concat(c.id)}),e," ",u?"".concat(u/1e3,"s"):null,Object(O.jsx)("div",{className:"coop-door_close btn",onClick:function(){h("closing"),p(o)},children:u&&"closing"===v?Object(O.jsx)(b,{initial:j,remaining:u,children:Object(O.jsxs)("div",{children:["Close ",o.id]})}):"Close ".concat(o.id)})]})},F=(t(19),function(n){var e=n.zoneInfo;return Object(O.jsxs)("div",{className:"zone btn ".concat(e.state),onClick:function(){return m(function(n){return Object(g.a)(Object(g.a)({},n),{},{state:(e=n.state,e===c.ON?c.OFF:c.ON)});var e}(e))},children:["Zone ",e.id]})}),I=[],S=function(n){var e=Object(u.a)(E,(function(e){e.id=n}));I.push(e)},R=1;R<=8;R++)S(R);!function(n){n.CONNECTING="connecting",n.OPEN="open",n.CLOSED="closed",n.ERROR="error"}(N||(N={}));var z=function(){var n=i.a.useState(I),e=Object(s.a)(n,2),t=e[0],c=e[1],o=i.a.useState(N.CONNECTING),r=Object(s.a)(o,2),a=r[0],d=r[1],l=function(n){var e;return t.forEach((function(t){t.id===n&&(e=t)})),e};i.a.useEffect((function(){a===N.ERROR||x||((x=new WebSocket(f)).onopen=function(){x.send(JSON.stringify({id:void 0,msg:"Client connected!"})),d(N.OPEN)},x.onmessage=function(n){var e;n||n.data||console.log("Error receving ws message or message data",n);try{(e=JSON.parse(n.data)).id=parseInt(e.id,10)}catch(i){throw console.log("Error parsing message.data from websockets"),new Error(i)}console.log("message from server",e);var o=Object(u.a)(t,(function(n){n[e.id-1]=e}));c(o)},x.onclose=function(){return d(N.CLOSED)},x.onerror=function(){x.close(),d(N.ERROR)})}),[a,t]);var j=l(5),b=l(6),v=l(7),h=l(8);return Object(O.jsxs)("div",{className:"App",children:[Object(O.jsxs)("header",{className:"App-header",children:[Object(O.jsx)("h1",{className:"title",children:"Martins' Sprinklers"}),Object(O.jsxs)("div",{className:"ws-status",children:["connection: ",a]})]}),Object(O.jsxs)("div",{className:"controls",children:[j&&b?Object(O.jsx)(k,{name:"Chickens",zoneInfos:[b,j]}):null,v&&h?Object(O.jsx)(k,{name:"Ducks",zoneInfos:[v,h]}):null,t.filter((function(n){return n.id<=8})).map((function(n){return Object(O.jsx)(F,{zoneInfo:n},n.id)}))]})]})},y=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,21)).then((function(e){var t=e.getCLS,c=e.getFID,o=e.getFCP,i=e.getLCP,r=e.getTTFB;t(n),c(n),o(n),i(n),r(n)}))};a.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(z,{})}),document.getElementById("root")),y()}],[[20,1,2]]]);
//# sourceMappingURL=main.ca3aa472.chunk.js.map